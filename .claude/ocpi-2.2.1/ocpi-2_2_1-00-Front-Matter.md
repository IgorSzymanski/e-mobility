# OCPI 2.2.1-d2 

#### Open Charge Point Interface 

###### https://github.com/ocpi & https://evroaming.org/ 

 document version 2.2.1-d3-pre1, 2023-09-07 


## Table of Contents 

1. OCPI.................................................................................................... 4     1.1. OCPI 2.2.1-d2......................................................................................... 4     1.2. OCPI 2.2.1........................................................................................... 4     1.3. OCPI 2.2............................................................................................. 4        1.3.1. Changes/New functionality:....................................................................... 4     1.4. Introduction and background......................................................................... 5 

2. Terminology and Definitions.............................................................................. 7     2.1. Requirement Keywords............................................................................... 7     2.2. Abbreviations........................................................................................ 7     2.3. EV Charging Market Roles............................................................................. 7        2.3.1. Typical OCPI implementations per Role............................................................ 8     2.4. Terminology......................................................................................... 9     2.5. Provider and Operator abbreviation.................................................................. 10        2.5.1. The Netherlands, Belgium and Luxembourg (BeNeLux)............................................ 10        2.5.2. Germany....................................................................................... 10        2.5.3. Austria......................................................................................... 10        2.5.4. France......................................................................................... 10        2.5.5. Hungary....................................................................................... 10        2.5.6. Poland......................................................................................... 10        2.5.7. UK............................................................................................. 11     2.6. Charging topology................................................................................... 11     2.7. Variable names..................................................................................... 11     2.8. Cardinality......................................................................................... 12     2.9. Data Retention...................................................................................... 12        2.9.1. Between OCPI version........................................................................... 12 

3. Supported Topologies.................................................................................... 13     3.1. Peer-to-peer........................................................................................ 13     3.2. Multiple peer-to-peer connections.................................................................... 13     3.3. Peer-to-peer multiple the same roles.................................................................. 14     3.4. Peer-to-peer dual roles.............................................................................. 14     3.5. Peer-to-peer mixed roles............................................................................. 15     3.6. Multiple peer-to-peer................................................................................ 16     3.7. Platforms via Hub................................................................................... 17     3.8. Platforms via Hub and direct......................................................................... 18 

4. Transport and format.................................................................................... 19     4.1. JSON / HTTP implementation guide................................................................... 19        4.1.1. Security and authentication...................................................................... 19        4.1.2. Authorization header........................................................................... 19        4.1.3. Pull and Push................................................................................... 20        4.1.4. Request format................................................................................. 20           4.1.4.1. GET........................................................................................ 20           4.1.4.2. PUT........................................................................................ 23           4.1.4.3. PATCH..................................................................................... 23        4.1.5. Client Owned Object Push....................................................................... 23           4.1.5.1. Errors..................................................................................... 23 


 4.1.6. Client Owned Object Pull........................................................................ 24 4.1.7. Response format................................................................................ 24 4.1.7.1. Example: Version information response (list of objects)........................................ 24 4.1.7.2. Example: Version details response (one object)................................................ 25 4.1.7.3. Example: Tokens GET Response with one Token object. (CPO end-point) (one object).............. 25 4.1.7.4. Example: Tokens GET Response with list of Token objects. (eMSP end-point) (list of objects)....... 25 4.1.7.5. Example: Response with an error (contains no data field)...................................... 26 4.1.8. Message Routing................................................................................ 26 4.1.8.1. Platforms.................................................................................. 26 4.1.8.2. Message Routing Headers................................................................... 27 4.1.8.3. Broadcast Push............................................................................. 28 4.1.8.4. Open Routing Request....................................................................... 30 4.1.8.5. GET All via Hubs............................................................................ 31 4.1.8.6. Overview of required/optional routing headers for different scenarios.......................... 32 4.1.8.7. GET All via Hubs............................................................................ 35 4.1.8.8. Timestamps and Objects send via Hubs....................................................... 35 4.1.9. No data available............................................................................... 36 4.2. Unique message IDs................................................................................. 36 4.3. Interface endpoints................................................................................. 37 4.4. Offline behaviour................................................................................... 37 

5. Status codes............................................................................................. 39     5.1. 1xxx: Success....................................................................................... 39     5.2. 2xxx: Client errors.................................................................................. 39     5.3. 3xxx: Server errors.................................................................................. 40     5.4. 4xxx: Hub errors.................................................................................... 40 

6. _Versions_ module......................................................................................... 41     6.1. Version information endpoint........................................................................ 41        6.1.1. Data........................................................................................... 41        6.1.2. Version _class_................................................................................... 41        6.1.3. GET............................................................................................ 41           6.1.3.1. Example................................................................................... 42     6.2. Version details endpoint............................................................................. 42        6.2.1. Data........................................................................................... 42        6.2.2. Endpoint _class_.................................................................................. 43        6.2.3. InterfaceRole _enum_............................................................................. 43        6.2.4. ModuleID _enum_................................................................................. 43        6.2.5. VersionNumber _enum_........................................................................... 44           6.2.5.1. Custom Modules............................................................................ 44        6.2.6. GET............................................................................................ 44           6.2.6.1. Examples.................................................................................. 44 

7. _Credentials_ module...................................................................................... 46     7.1. Use cases........................................................................................... 46        7.1.1. Registration.................................................................................... 46        7.1.2. Updating to a newer version..................................................................... 48        7.1.3. Changing endpoints for the current version....................................................... 48        7.1.4. Updating the credentials and resetting the credentials token........................................ 48        7.1.5. Errors during registration....................................................................... 49 


 7.1.6. Required endpoints not available................................................................ 49 7.2. Interfaces and endpoints............................................................................ 49 7.2.1. GET Method.................................................................................... 49 7.2.2. POST Method................................................................................... 50 7.2.3. PUT Method.................................................................................... 50 7.2.4. DELETE Method................................................................................ 50 7.3. Object description................................................................................... 50 7.3.1. Credentials object............................................................................... 50 7.3.2. Examples...................................................................................... 51 7.4. Data types.......................................................................................... 52 7.4.1. CredentialsRole class............................................................................ 53 

8. _Locations_ module....................................................................................... 54     8.1. Flow and Lifecycle.................................................................................. 54        8.1.1. No public charging or roaming................................................................... 54        8.1.2. Group of Charge Points.......................................................................... 54        8.1.3. OCPP 1.x Charge Points with multiple connectors per EVSE......................................... 55     8.2. Interfaces and endpoints............................................................................ 55        8.2.1. Sender Interface................................................................................ 55           8.2.1.1. **GET** Method................................................................................ 56        8.2.2. Receiver Interface.............................................................................. 58           8.2.2.1. **GET** Method................................................................................ 58           8.2.2.2. **PUT** Method................................................................................ 59           8.2.2.3. **PATCH** Method............................................................................. 60     8.3. Object description................................................................................... 61        8.3.1. _Location_ Object................................................................................. 62           8.3.1.1. Example public charging location............................................................ 64           8.3.1.2. Example destination charging location....................................................... 65           8.3.1.3. Example destination charging location not published, but paid guest usage possible.............. 66           8.3.1.4. Example charging location with limited visibility.............................................. 67           8.3.1.5. Example private charge point with eMSP app control.......................................... 68           8.3.1.6. Example charge point in a parking garage with opening hours................................. 69        8.3.2. _EVSE_ Object.................................................................................... 70        8.3.3. _Connector_ Object................................................................................ 72     8.4. Data types.......................................................................................... 73        8.4.1. AdditionalGeoLocation _class_..................................................................... 73        8.4.2. BusinessDetails _class_............................................................................ 73        8.4.3. Capability _enum_................................................................................ 73        8.4.4. ConnectorFormat _enum_.......................................................................... 74        8.4.5. ConnectorType _enum_............................................................................ 74        8.4.6. EnergyMix _class_................................................................................ 76           8.4.6.1. Examples.................................................................................. 76        8.4.7. EnergySource _class_.............................................................................. 77        8.4.8. EnergySourceCategory _enum_..................................................................... 77        8.4.9. EnvironmentalImpact _class_...................................................................... 77        8.4.10. EnvironmentalImpactCategory _enum_............................................................ 78        8.4.11. ExceptionalPeriod _class_........................................................................ 78        8.4.12. Facility _enum_.................................................................................. 78 


 8.4.13. GeoLocation class.............................................................................. 79 8.4.14. Hours class.................................................................................... 79 8.4.14.1. Example: 24/7 open with exceptional closing................................................. 79 8.4.14.2. Example: Opening Hours with exceptional closing............................................ 80 8.4.14.3. Example: Opening Hours with exceptional opening........................................... 81 8.4.15. Image class.................................................................................... 81 8.4.16. ImageCategory enum........................................................................... 82 8.4.17. ParkingRestriction enum....................................................................... 83 8.4.18. ParkingType enum............................................................................. 83 8.4.19. PowerType enum.............................................................................. 83 8.4.20. PublishTokenType class........................................................................ 83 8.4.21. RegularHours class............................................................................ 84 8.4.21.1. Example.................................................................................. 84 8.4.22. Status enum................................................................................... 85 8.4.23. StatusSchedule class........................................................................... 86 

9. _Sessions_ module......................................................................................... 87     9.1. Flow and Lifecycle.................................................................................. 87        9.1.1. Push model..................................................................................... 87        9.1.2. Pull model...................................................................................... 87        9.1.3. Set: Charging Preferences........................................................................ 87        9.1.4. Reservation.................................................................................... 87     9.2. Interfaces and Endpoints............................................................................ 88        9.2.1. Sender Interface................................................................................ 88           9.2.1.1. **GET** Method................................................................................ 88           9.2.1.2. **PUT** Method................................................................................ 89        9.2.2. Receiver Interface.............................................................................. 90           9.2.2.1. **GET** Method................................................................................ 90           9.2.2.2. **PUT** Method................................................................................ 91           9.2.2.3. **PATCH** Method............................................................................. 92     9.3. Object description................................................................................... 92        9.3.1. _Session_ Object.................................................................................. 93           9.3.1.1. Examples.................................................................................. 95        9.3.2. _ChargingPreferences_ Object...................................................................... 96     9.4. Data types.......................................................................................... 96        9.4.1. ChargingPreferencesResponse _enum_.............................................................. 96        9.4.2. ProfileType _enum_............................................................................... 97        9.4.3. SessionStatus _enum_............................................................................. 97 

10. _CDRs_ module.......................................................................................... 98     10.1. Flow and Lifecycle................................................................................. 98        10.1.1. Credit CDRs................................................................................... 98        10.1.2. Push model.................................................................................... 98        10.1.3. Pull model.................................................................................... 99     10.2. Interfaces and Endpoints........................................................................... 99        10.2.1. Sender Interface............................................................................... 99           10.2.1.1. **GET** Method.............................................................................. 99        10.2.2. Receiver Interface............................................................................ 100           10.2.2.1. GET Method.............................................................................. 100 


 10.2.2.2. POST Method............................................................................. 101 10.3. Object description................................................................................. 102 10.3.1. CDR Object................................................................................... 102 10.3.1.1. Example of a CDR......................................................................... 106 10.4. Data types........................................................................................ 107 10.4.1. AuthMethod enum............................................................................ 107 10.4.2. CdrDimension class........................................................................... 107 10.4.3. CdrDimensionType enum...................................................................... 107 10.4.4. CdrLocation class............................................................................. 108 10.4.5. CdrToken class............................................................................... 109 10.4.6. ChargingPeriod class.......................................................................... 110 10.4.7. SignedData class.............................................................................. 110 10.4.8. SignedValue class............................................................................. 111 

11. _Tariffs_ module........................................................................................ 112     11.1. Flow and Lifecycle................................................................................ 112        11.1.1. Push model.................................................................................. 112        11.1.2. Pull model................................................................................... 112     11.2. Interfaces and Endpoints.......................................................................... 112        11.2.1. Sender Interface.............................................................................. 112           11.2.1.1. **GET** Method............................................................................. 113        11.2.2. Receiver Interface............................................................................ 114           11.2.2.1. **GET** Method............................................................................. 114           11.2.2.2. **PUT** Method............................................................................. 115           11.2.2.3. **DELETE** Method.......................................................................... 116     11.3. Object description................................................................................. 116        11.3.1. _Tariff_ Object.................................................................................. 116           11.3.1.1. Examples................................................................................ 118     11.4. Data types........................................................................................ 134        11.4.1. DayOfWeek _enum_............................................................................. 134        11.4.2. PriceComponent _class_......................................................................... 135           11.4.2.1. Example Tariff........................................................................... 136        11.4.3. ReservationRestrictionType _enum_.............................................................. 138        11.4.4. TariffElement _class_........................................................................... 138        11.4.5. TariffDimensionType _enum_.................................................................... 139        11.4.6. TariffRestrictions _class_........................................................................ 139           11.4.6.1. Example: Tariff with max_power Tariff Restrictions......................................... 141           11.4.6.2. Example: Tariff with max_duration Tariff Restrictions....................................... 142        11.4.7. TariffType _enum_.............................................................................. 143 

12. _Tokens_ module........................................................................................ 144     12.1. Flow and Lifecycle................................................................................ 144        12.1.1. Push model.................................................................................. 144        12.1.2. Pull model................................................................................... 144        12.1.3. Real-time authorization....................................................................... 144     12.2. Interfaces and endpoints.......................................................................... 145        12.2.1. Receiver Interface............................................................................ 145           12.2.1.1. **GET** Method............................................................................. 145           12.2.1.2. **PUT** Method............................................................................. 146 


 12.2.1.3. PATCH Method........................................................................... 147 12.2.2. Sender Interface.............................................................................. 147 12.2.2.1. GET Method............................................................................. 147 12.2.2.2. POST Method............................................................................ 148 12.3. Object description................................................................................. 150 12.3.1. AuthorizationInfo Object...................................................................... 150 12.3.2. Token Object................................................................................. 150 12.3.2.1. Examples................................................................................ 151 12.4. Data types........................................................................................ 152 12.4.1. AllowedType enum............................................................................ 152 12.4.2. EnergyContract class.......................................................................... 152 12.4.3. LocationReferences class...................................................................... 153 12.4.4. TokenType enum............................................................................. 153 12.4.5. WhitelistType enum........................................................................... 153 

13. _Commands_ module.................................................................................... 154     13.1. Flow............................................................................................. 154     13.2. Interfaces and endpoints.......................................................................... 158        13.2.1. Receiver Interface............................................................................ 158           13.2.1.1. **POST** Method............................................................................ 158           13.2.1.2. Request Body............................................................................ 158        13.2.2. Sender Interface.............................................................................. 159           13.2.2.1. **POST** Method............................................................................ 160           13.2.2.2. Request Body............................................................................ 160     13.3. Object description................................................................................. 160        13.3.1. _CancelReservation_ Object...................................................................... 160        13.3.2. _CommandResponse_ Object..................................................................... 160        13.3.3. _CommandResult_ Object........................................................................ 161        13.3.4. _ReserveNow_ Object............................................................................ 161        13.3.5. _StartSession_ Object............................................................................ 162        13.3.6. _StopSession_ Object............................................................................ 163        13.3.7. _UnlockConnector_ Object....................................................................... 164     13.4. Data types........................................................................................ 164        13.4.1. CommandResponseType _enum_................................................................. 164        13.4.2. CommandResultType _enum_.................................................................... 164        13.4.3. CommandType _enum_.......................................................................... 165 

14. _ChargingProfiles_ module............................................................................... 166     14.1. Smart Charging Topologies........................................................................ 166        14.1.1. The eMSP generates ChargingProfiles........................................................... 167        14.1.2. The eMSP delegated Smart Charging to SCSP..................................................... 167        14.1.3. The CPO delegated Smart Charging to SCSP...................................................... 167     14.2. Use Cases......................................................................................... 168     14.3. Flow............................................................................................. 168        14.3.1. Example of setting/updating a ChargingProfile by the Sender (typically the SCSP or eMSP).......... 169        14.3.2. Example of a setting/updating a ChargingProfile by the SCSP via the eMSP......................... 170        14.3.3. Example of a removing/clearing ChargingProfile sent by the Sender (typically the eMSP or SCSP).... 171        14.3.4. Example of a removing/clearing ChargingProfile send by the SCSP via the eMSP................... 171        14.3.5. Example of a GET ActiveChargingProfile send by the Sender (typically the eMSP or SCSP)........... 172 


 14.3.6. Example of a GET ActiveChargingProfile send by the SCSP via eMSP............................... 173 14.3.7. Example of the Receiver (typically the CPO) sending an updated ActiveChargingProfile............. 173 14.3.8. Example of the Receiver (typically the CPO) sending an updated ActiveChargingProfile to the SCSP via the eMSP........................................................................................ 174 14.4. Interfaces and endpoints.......................................................................... 174 14.4.1. Receiver Interface............................................................................ 174 14.4.1.1. GET Method............................................................................. 175 14.4.1.2. PUT Method............................................................................. 176 14.4.1.3. Request Body............................................................................ 176 14.4.1.4. DELETE Method.......................................................................... 177 14.4.2. Sender Interface.............................................................................. 177 14.4.2.1. POST Method............................................................................ 178 14.4.2.2. Request Body............................................................................ 178 14.4.2.3. Response Body........................................................................... 179 14.4.2.4. PUT Method............................................................................. 179 14.4.2.5. Request Body............................................................................ 179 14.4.2.6. Response Body........................................................................... 180 14.5. Object description................................................................................. 180 14.5.1. ChargingProfileResponse Object................................................................ 180 14.5.2. ActiveChargingProfileResult Object............................................................. 180 14.5.3. ChargingProfileResult Object................................................................... 180 14.5.4. ClearProfileResult Object...................................................................... 181 14.5.5. SetChargingProfile Object...................................................................... 181 14.6. Data types........................................................................................ 181 14.6.1. ActiveChargingProfile class.................................................................... 181 14.6.2. ChargingRateUnit enum....................................................................... 181 14.6.3. ChargingProfile class.......................................................................... 182 14.6.4. ChargingProfilePeriod class................................................................... 182 14.6.5. ChargingProfileResponseType enum............................................................ 183 14.6.6. ChargingProfileResultType enum............................................................... 183 

15. _HubClientInfo_ module................................................................................. 184     15.1. Scenarios......................................................................................... 184        15.1.1. Another Party becomes CONNECTED........................................................... 184        15.1.2. Another Party goes OFFLINE................................................................... 184        15.1.3. Another Party becomes PLANNED.............................................................. 184        15.1.4. Another Party becomes SUSPENDED........................................................... 184     15.2. Flow and Life-cycle............................................................................... 184        15.2.1. Push model.................................................................................. 184        15.2.2. Pull model................................................................................... 185        15.2.3. Still alive check............................................................................... 185     15.3. Interfaces........................................................................................ 185        15.3.1. Receiver Interface............................................................................ 185           15.3.1.1. **GET** Method............................................................................. 186           15.3.1.2. **PUT** Method............................................................................. 186        15.3.2. Sender Interface.............................................................................. 187           15.3.2.1. **GET** Method............................................................................. 187           15.3.2.2. Request Parameters...................................................................... 187 


 15.3.2.3. Response Data............................................................................ 188 15.4. Object description................................................................................. 188 15.4.1. ClientInfo Object.............................................................................. 188 15.5. Data types........................................................................................ 188 15.5.1. ConnectionStatus enum....................................................................... 188 

16. Types................................................................................................ 190     16.1. CiString _type_...................................................................................... 190     16.2. DateTime _type_.................................................................................... 190     16.3. DisplayText _class_.................................................................................. 190     16.4. number _type_...................................................................................... 190     16.5. Price _class_........................................................................................ 191     16.6. Role _enum_........................................................................................ 191     16.7. string _type_........................................................................................ 191     16.8. URL _type_......................................................................................... 191 

17. Changelog............................................................................................ 192     17.1. Changes between 2.2.1 and 2.2.1-d2................................................................. 192     17.2. Changes between OCPI 2.2 and 2.2.1................................................................ 192     17.3. Changes between OCPI 2.1.1 and 2.2................................................................ 193 


Copyright © 2014 – 2023 EVRoaming Foundation. All rights reserved. 

This document is made available under the _Creative Commons AttributionNoDerivatives 4.0 International Public License_ 

(https://creativecommons.org/licenses/by-nd/4.0/legalcode). 

**EVRoaming Foundation** 

OCPI is developed and managed by the EVRoaming Foundation. The EVRoaming Foundation is a contributor based organisation. Everyone can join the EVRoaming Foundation via https://www.evroaming.org 

The EVRoaming Foundation strive to keep OCPI as free from IPR as possible. If you want to contribute by adding new functionality/features, you are required to send us the signed Contributor Agreement (CA) document before contributing. To get the CA, ask for it by send an e-mail to: info@evroaming.org. 


**Version History** 

 Version Date Author Description 

 2.2.1-d2 2023-09-07 Jakub Karbownik Ekoenergetyka Rudolph Froger TandemDrive Robert de Leeuw EVA Global Reinier Lamers ihomer 

 Documentation update. 

 2.2.1 2021-10-06 Robert de Leeuw ihomer Reinier Lamers ihomer 

 final release of OCPI 2.2.1. Added country_code and party_id to CdrToken class. 

 Fixed datatype of CDR SignedData URL. Improved some descriptions. 

 Fixed length of CDR SignedData, increased to 5000. Change signed data related fields to string postal_code optional in CdrLocation. state added to CdrLocation. AC_2_PHASE and AC_2_PHASE_SPLIT added to PowerType in Connector Additional types added to ConnectorType in Connector Added connector_id to StartSession command and START_SESSION_CONNECTOR_REQUIRED to EVSE Capabilities. Added optional field: home_charging_compensation to CDR. Improved description.examples Tariff for step_size 

 2.2-d2 2020-06-12 Robert de Leeuw ihomer 

 2nd documentation revision of the OCPI 2.2 spec. Contains textual improvements and fixes some of the examples. Most improvements in the tarrifs module, especially step_size is better explained. 

 2.2 2019-09-30 Robert de Leeuw ihomer 

 Added support for Roaming Hubs Adds support for Platforms with multiple/different roles, additional roles Adds support for smart charging Lots of improvements to existing modules See changelog 

 2.1.1-d2 2019-06-21 Robert de Leeuw ihomer 

 Fixes the command module documentation, fixes a lot of examples, lots of small textual improvements: see changelog 

 2.1.1 2017-06-08 Robert de Leeuw ihomer 

 Fixed 4 bugs found in OCPI 2.1, lots of small textual improvements: see changelog 


 Version Date Author Description 

 2.1 2016-04-08 Robert de Leeuw ihomer 

 Added command module. Added support for real-time authorization. Lots of small improvements: see changelog 

 2.0-d2 2016-02-15 Robert de Leeuw ihomer 

 2nd documentation revision of the OCPI 2.0 spec. Only documentation updated: ConnectorType of Connector was not visible, credentials clarified, location URL segments incorrect (now string, was int), minor textual updates. DateTime with timezones is still an issue 

 2.0 2015-12-30 Robert de Leeuw ihomer Simon Philips Becharged Chris Zwirello The New Motion Simon Schilling 

 First official release of OCPI. 

 0.4 2014-11-04 Olger Warnier The New Motion 

 First draft of OCPI. (Also known as Draft v4) 

 0.3 2014-05-06 Olger Warnier The New Motion 

 First draft of OCPI. (Also known as Draft v3) 

**Document revisions** There can be multiple documentation revisions of the same version of the OCPI protocol. 

The newer documentation revisions of the same protocol version can never change the content of the messages: no new fields or renaming of fields. A new revision can only clarify/fix texts/descriptions and fix typos etc. 

These documentation revisions (not the first) will be named: d2, d3, d4 etc. 

Examples: 

- OCPI 2.1.1 is a different protocol version of OCPI than OCPI 2.1. 

- OCPI 2.2-d2 is the same protocol version as OCPI 2.2, but a newer documentation revision.
